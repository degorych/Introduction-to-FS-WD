<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport"
					content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>WD_PS2 Javascript (Basics)</title>
		<link rel="stylesheet" href="style.css">
	</head>
	<body class="body">
		<div class="1task">
			<h2>Я считаю сумму чисел от "-1000" до "1000"</h2>
			<form action="">
				<input id="minNum" type="text" value="-1000" onchange="changeSumma()">
				<input id="maxNum" type="text" value="1000" onchange="changeSumma()">
				<label>Результат:&nbsp;</label>
				<output id="summ"></output>
			</form>
		</div>
		<div class="2task">
			<h2>Я считаю сумму чисел, оканчивающихся на 2, 3, 7</h2>
			<label>Результат:&nbsp;</label>
			<output id="summ-2-3-7"></output>
		</div>
		<div class="3task">
			<h2>Я рисую картинку из <input id="number-of-stars" type="text" value="50" onchange="changeStars()"/>звезд</h2>
			<div id="star-img"></div>
		</div>
		<div class="4task">
			<h2>Я перевожу секунды в часы и минуты</h2>
			<input id="user-sec" type="text" value="0" onchange="colculateDate()"/>
			<label>Результат:&nbsp;</label>
			<output id="sec-to-hours">00:00:00</output>
		</div>
		<div class="5task">
			<h2>Я вывожу возраст студентов</h2>
			<input id="student-year" type="number" value="0" onchange="getStudentsYear()"/>
			<output id="student-year-string">0 &nbsp лет</output>
		</div>
		<div class="6task">
			<h2>Я считаю промежуток времени между датами</h2>
			<input type="text" id="1data" value="October 13, 2014 11:13:00" onchange="getUserDate()"/>
			<input type="text" id="2data" value="October 14, 2014 11:13:00" onchange="getUserDate()"/>
			<label>Между датами прошло:&nbsp</label>
			<output id="time-between-dates"></output>
		</div>
		<div class="7task"></div>
		<div class="8task"></div>
		<div class="9task"></div>
		<div class="10task"></div>
		<div class="11task"></div>
	</body>
	<script>

      /*--- Task 1, Task 2 ---*/

      function summa() {
          var minNum = parseInt(document.getElementById("minNum").value);
          var maxNum = parseInt(document.getElementById("maxNum").value);

          if (checkNum(minNum) == "error" || checkNum(maxNum) == "error") {
              return;
          }

          var result = 0;
          var result237 = 0;

          for (minNum; minNum<=maxNum; minNum++) {
              result = result + minNum;
              if (minNum.toString().slice(-1) == 2 || minNum.toString().slice(-1) == 3 || minNum.toString().slice(-1) == 7) {
                  result237 = result237 + minNum;
              }
          }

          document.getElementById("summ").value = result;
          document.getElementById("summ-2-3-7").value = result237;
      }

      function checkNum(num) {
          var errorValue = "Your numbers may be from \"-1000\" to \"1000\"";
          var errorType = "Your data may be number";

          if (num>1000 || num<-1000) {
              document.getElementById("summ").value = errorValue;
              document.getElementById("summ-2-3-7").value = errorValue;
              return "error";
          }
          else if (isNaN(parseFloat(num)) && !isFinite(num)) {
              document.getElementById("summ").value = errorType;
              document.getElementById("summ-2-3-7").value = errorType;
              return "error";
          }
      }

      function changeSumma() {
          summa();
      }

      summa();

      /* --- Task 3 ---*/

      function createStarImg() {
          var i, j;
          var n = parseInt(document.getElementById("number-of-stars").value);

          for (i=1; n>0; i++) {
              for (j=1; j<=i && n>0; j++) {
                  document.getElementById("star-img").innerHTML += "*";
                  n--;
              }
              document.getElementById("star-img").innerHTML += "<br>";
          }
      }

      function changeStars() {
          document.getElementById("star-img").innerHTML = "";
          createStarImg();
      }

      createStarImg();

      /*--- Task 4 ---*/

      function secondToHours(numSec) {
          var date = new Date(2018, 1);
          var dateOptions = {
              hour: "numeric",
              minute: "numeric",
              second: "numeric"
          };

          date.setSeconds(numSec);

          if (date.getHours()<10) {
              document.getElementById("sec-to-hours").innerHTML = "0"+date.toLocaleString("ru", dateOptions);
          }
          else {
              document.getElementById("sec-to-hours").innerHTML = date.toLocaleString("ru", dateOptions);
          }
      }

      function colculateDate() {
          var secunda = document.getElementById("user-sec").value;
          secondToHours(secunda);
      }

      /*--- Task 5 ---*/

      function getStudentsYear() {
          var yearVariables = [" лет ", " год ", " года ", " года ", " года ", " лет ", " лет ", " лет ", " лет ", " лет "];
          var getStudentYear = document.getElementById("student-year").value;

          document.getElementById("student-year-string").innerHTML = "";
          getTextForDate(getStudentYear, yearVariables, "student-year-string");
      }

			function getTextForDate(dateValue, textArray, innerId) {

          /* --- for 10, 11, 12,...,19 and 110,...,119,... --- */
          if (("0"+dateValue).slice(-2, -1) == 1) {
              document.getElementById(innerId).innerHTML += parseInt(dateValue)+textArray[0];
          }

          /* --- for other --- */
          else {
              document.getElementById(innerId).innerHTML += parseInt(dateValue)+textArray[parseInt(("0"+dateValue).slice(-1))];
          }
      }

      /* --- Task 6 --- */

      function getUserDate() {
          document.getElementById("time-between-dates").innerHTML = "";

          var fDate = new Date(Date.parse(document.getElementById("1data").value));
          var sDate = new Date(Date.parse(document.getElementById("2data").value));

          sDate.setSeconds(sDate.getSeconds()-fDate.getSeconds());
          sDate.setMinutes(sDate.getMinutes()-fDate.getMinutes());
          sDate.setHours(sDate.getHours()-fDate.getHours());
          sDate.setDate(sDate.getDate()-fDate.getDate());
          sDate.setMonth(sDate.getMonth()-fDate.getMonth());
          sDate.setFullYear(sDate.getFullYear()-fDate.getFullYear());

          sDate.setMinutes(sDate.getMinutes() + (sDate.getTimezoneOffset())*(-1)); // Convet to  UTC timezone.

          var timeBetweenDates = sDate.toISOString().split(/[\s-T.:/]+/);
          timeBetweenDates[1] -= 1; // In ISO view mount contain from 1 to 12 values.


          var dateText = [
              [" лет ", " год ", " года ", " года ", " года ", " лет ", " лет ", " лет ", " лет ", " лет "],
              [" месяцев ", " месяц ", " месяца ", " месяца ", " месяца ", " месяцев ", " месяцев ", " месяцев ", " месяцев ", " месяцев "],
              [" дней ", " день ", " дня ", " дня ", " дня "," дней ", " дней ", " дней ", " дней ", " дней "],
              [" часов ", " час ", " часа ", " часа ", " часа ", " часов ", " часов ", " часов ", " часов ", " часов "],
              [" минут ", " минута ", " минуты ", " минуты ", " минуты ", " минут ", " минут ", " минут ", " минут ", " минут "],
							[" секунд ", " секунда ", " секунды ", " секунды ", " секунды ", " секунд ", " секунд ", " секунд ", " секунд ", " секунд "]
					];

					var i;
					for (i=0; i<6; i++) {
              getTextForDate(timeBetweenDates[i], dateText[i], "time-between-dates");
					}
      }

      getUserDate();

	</script>
</html>